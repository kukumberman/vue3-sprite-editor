(function(e){function t(t){for(var r,o,c=t[0],l=t[1],s=t[2],p=0,d=[];p<c.length;p++)o=c[p],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var l=n[c];0!==i[l]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/vue3-sprite-editor/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},2:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),i={class:"settings-container"},a={class:"settings-grid"},o=Object(r["createElementVNode"])("span",null,"Grid X",-1),c=Object(r["createElementVNode"])("span",null,"Grid Y",-1),l={class:"settings-pivot"},s=Object(r["createElementVNode"])("span",null,"Pivot X",-1),u=Object(r["createElementVNode"])("span",null,"Pivot Y",-1),p=Object(r["createElementVNode"])("span",null,"Show Grid",-1),d=Object(r["createElementVNode"])("span",null,"Display Background",-1),f=Object(r["createElementVNode"])("span",null,"useNextPow2",-1),m=Object(r["createElementVNode"])("span",null,"autoUpdate",-1),h=["disabled"],b=["disabled"],v=["disabled"];function g(e,t,n,g,y,O){var j=Object(r["resolveComponent"])("FileView"),x=Object(r["resolveComponent"])("GridView"),k=Object(r["resolveComponent"])("FooterView");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createVNode"])(j,{files:y.files,onOnFilesDrop:O.onFilesDrop,onOnFilesUploaded:O.onFilesUploaded,onClickRemoveFile:O.clickRemoveFile,onClearClick:O.clearClick,onOnFileDragEnd:O.onFileDragEnd},null,8,["files","onOnFilesDrop","onOnFilesUploaded","onClickRemoveFile","onClearClick","onOnFileDragEnd"]),Object(r["createElementVNode"])("div",i,[Object(r["createElementVNode"])("div",a,[Object(r["createElementVNode"])("div",null,[o,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=function(e){return y.grid.x=e}),min:"0"},null,512),[[r["vModelText"],y.grid.x]])]),Object(r["createElementVNode"])("div",null,[c,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=function(e){return y.grid.y=e}),min:"0"},null,512),[[r["vModelText"],y.grid.y]])])]),Object(r["createElementVNode"])("div",l,[Object(r["createElementVNode"])("div",null,[s,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=function(e){return y.pivot.x=e}),step:"0.1",min:"0",max:"1"},null,512),[[r["vModelText"],y.pivot.x]])]),Object(r["createElementVNode"])("div",null,[u,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=function(e){return y.pivot.y=e}),step:"0.1",min:"0",max:"1"},null,512),[[r["vModelText"],y.pivot.y]])])]),Object(r["createElementVNode"])("div",null,[p,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=function(e){return y.display.grid=e})},null,512),[[r["vModelCheckbox"],y.display.grid]])]),Object(r["createElementVNode"])("div",null,[d,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=function(e){return y.display.background=e})},null,512),[[r["vModelCheckbox"],y.display.background]])]),Object(r["createElementVNode"])("div",null,[f,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=function(e){return y.useNextPow2=e})},null,512),[[r["vModelCheckbox"],y.useNextPow2]])]),Object(r["createElementVNode"])("div",null,[m,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=function(e){return y.autoUpdate=e})},null,512),[[r["vModelCheckbox"],y.autoUpdate]])]),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("button",{onClick:t[8]||(t[8]=function(){return O.createGrid&&O.createGrid.apply(O,arguments)}),disabled:O.hasNoFiles},"Pack grid",8,h),Object(r["createElementVNode"])("button",{onClick:t[9]||(t[9]=function(){return O.createHorizontal&&O.createHorizontal.apply(O,arguments)}),disabled:O.hasNoFiles},"Pack horizontal",8,b),Object(r["createElementVNode"])("button",{onClick:t[10]||(t[10]=function(){return O.createVertical&&O.createVertical.apply(O,arguments)}),disabled:O.hasNoFiles},"Pack vertical",8,v)])]),Object(r["createVNode"])(x,{sprite:y.sprite,grid:y.grid,pivot:y.pivot,display:y.display},null,8,["sprite","grid","pivot","display"]),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("button",{onClick:t[11]||(t[11]=function(){return O.save&&O.save.apply(O,arguments)})},"Save")]),Object(r["createVNode"])(k,{link:"https://github.com/kukumberman/vue3-sprite-editor"})],64)}var y=n("2909"),O=n("1da1"),j=(n("96cf"),n("d3b7"),n("d81d"),n("a630"),n("3ca3"),n("b0c0"),n("ddb0"),n("a434"),n("21a6")),x=n.n(j),k={class:"file-container"},w=Object(r["createTextVNode"])(" Â  "),V=["onClick"];function N(e,t,n,i,a,o){var c=Object(r["resolveComponent"])("draggable");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createElementVNode"])("input",{type:"file",onChange:t[0]||(t[0]=function(){return o.onFilesUploaded&&o.onFilesUploaded.apply(o,arguments)}),ref:"fileInput",accept:"image/png, image/jpeg",multiple:""},null,544),Object(r["createElementVNode"])("div",k,[Object(r["createElementVNode"])("div",{id:"drop-zone",onClick:t[1]||(t[1]=function(){return o.dropzoneClickHandler&&o.dropzoneClickHandler.apply(o,arguments)}),onDrop:t[2]||(t[2]=function(){return o.onFilesDrop&&o.onFilesDrop.apply(o,arguments)}),onDragover:t[3]||(t[3]=function(e){return e.preventDefault()})},"Drop file(s) or click here!",32),Object(r["createVNode"])(c,{modelValue:n.files,"onUpdate:modelValue":t[4]||(t[4]=function(e){return n.files=e}),"item-key":"name",onEnd:o.onFileDragEnd,tag:"ul"},{item:Object(r["withCtx"])((function(e){var t=e.element,n=e.index;return[Object(r["createElementVNode"])("li",null,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(t.name),1),w,Object(r["createElementVNode"])("button",{onClick:function(e){return o.clickRemoveFile(n)}},"Remove",8,V)])]})),_:1},8,["modelValue","onEnd"]),n.files.length>0?(Object(r["openBlock"])(),Object(r["createElementBlock"])("button",{key:0,onClick:t[5]||(t[5]=function(){return o.clearClick&&o.clearClick.apply(o,arguments)})},"Clear")):Object(r["createCommentVNode"])("",!0)])],64)}var E=n("b76a"),F=n.n(E),D={emits:["onFilesDrop","onFilesUploaded","clickRemoveFile","clearClick","onFileDragEnd"],props:{files:{type:Array,required:!0}},components:{draggable:F.a},methods:{dropzoneClickHandler:function(){this.$refs.fileInput.click()},onFilesDrop:function(e){e.preventDefault(),this.$emit("onFilesDrop",e.dataTransfer.files)},onFilesUploaded:function(e){this.$emit("onFilesUploaded",e.target.files),e.target.value=""},clickRemoveFile:function(e){this.$emit("clickRemoveFile",e)},clearClick:function(){this.$emit("clearClick")},onFileDragEnd:function(e){this.$emit("onFileDragEnd",e,this.files)}}},C=n("d959"),U=n.n(C);const z=U()(D,[["render",N]]);var P=z,B=["src"],M={class:"circle"};function R(e,t,n,i,a,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])(["atlas-container",{bg:n.display.background}]),style:Object(r["normalizeStyle"])(o.atlasSize)},[Object(r["createElementVNode"])("img",{src:n.sprite.image,alt:"atlas",style:Object(r["normalizeStyle"])(o.atlasSize)},null,12,B),Object(r["createElementVNode"])("div",{class:Object(r["normalizeClass"])(["grid",{visible:n.display.grid}]),style:Object(r["normalizeStyle"])(o.gridTemplate)},[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(o.framesCount,(function(e){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:"frame",key:e,style:Object(r["normalizeStyle"])(o.frameSize)},[Object(r["createElementVNode"])("div",M,[Object(r["createElementVNode"])("span",null,Object(r["toDisplayString"])(e),1)]),Object(r["createElementVNode"])("div",{class:"pivot",style:Object(r["normalizeStyle"])(o.pivotPosition)},null,4)],4)})),128))],6)],6)}var S={props:{sprite:{type:Object,required:!0},grid:{type:Object,required:!0},pivot:{type:Object,required:!0},display:{type:Object,required:!0}},computed:{frame:function(){return{x:this.sprite.size.x/this.grid.x,y:this.sprite.size.y/this.grid.y}},framesCount:function(){return this.grid.x*this.grid.y},pivotPosition:function(){return{left:"calc(".concat(this.pivot.x," * 100%)"),top:"calc(".concat(this.pivot.y," * 100%)")}},frameSize:function(){return{width:"".concat(this.frame.x,"px"),height:"".concat(this.frame.y,"px")}},atlasSize:function(){return{width:"".concat(this.sprite.size.x,"px"),height:"".concat(this.sprite.size.y,"px")}},gridTemplate:function(){return{"grid-template-columns":"repeat(".concat(this.grid.x,", 1fr)"),"grid-template-rows":"repeat(".concat(this.grid.y,", 1fr)")}}}};const G=U()(S,[["render",R]]);var A=G,T=(n("9911"),["href"]);function H(e,t,n,i,a,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("a",{href:n.link,target:"_blank"},Object(r["toDisplayString"])(n.link),9,T)}var _={props:{link:{type:String,required:!0}}};const q=U()(_,[["render",H]]);var $=q,I=n("d4ec"),J=n("bee2"),L=n("ef21"),X=n.n(L);function Y(e){var t=Math.ceil(Math.log(e)/Math.log(2));return Math.pow(2,t)}var K=function(){function e(t,n){Object(I["a"])(this,e),this.buffers=t,this.useNextPow2=n}return Object(J["a"])(e,[{key:"calculateFrame",value:function(){var e=Math.max.apply(Math,Object(y["a"])(this.images.map((function(e){return e.bitmap.width})))),t=Math.max.apply(Math,Object(y["a"])(this.images.map((function(e){return e.bitmap.height})))),n={width:this.useNextPow2?Y(e):e,height:this.useNextPow2?Y(t):t};return n}},{key:"getOffset",value:function(e,t,n){var r=e.bitmap,i=r.width,a=r.height,o={x:(t.width-i)*n.x,y:(t.height-a)*n.y};return o}},{key:"createGrid",value:function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(t,n){var r,i,a,o,c,l,s,u,p,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.buffers.map((function(e){return X.a.read(e)})));case 2:this.images=e.sent,r=this.calculateFrame(),this.options={grid:t,pivot:n,frame:r},i=r.width*t.x,a=r.height*t.y,o=new X.a(i,a),c=0;case 9:if(!(c<t.y)){e.next=25;break}l=0;case 11:if(!(l<t.x)){e.next=22;break}if(s=c*t.x+l,u=this.images[s],u){e.next=16;break}return e.abrupt("break",22);case 16:p=this.getOffset(u,r,n),d={x:l*r.width+p.x,y:c*r.height+p.y},o.composite(u,d.x,d.y);case 19:l++,e.next=11;break;case 22:c++,e.next=9;break;case 25:return e.abrupt("return",o.getBase64Async(X.a.MIME_PNG));case 26:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"createHorizontal",value:function(e){var t={x:this.buffers.length,y:1};return this.createGrid(t,e)}},{key:"createVertical",value:function(e){var t={x:1,y:this.buffers.length};return this.createGrid(t,e)}}]),e}();function Q(e){return new Promise((function(t,n){var r=new FileReader;r.readAsArrayBuffer(e),r.onload=function(){return t(r.result)}}))}var W={name:"App",components:{FileView:P,GridView:A,FooterView:$},data:function(){return{sprite:{image:"./images/placeholder.png",size:{x:500,y:500}},grid:{x:2,y:2},pivot:{x:.5,y:.5},files:[],display:{grid:!0,background:!0},useNextPow2:!0,autoUpdate:!0}},methods:{save:function(){try{new Blob;var e="image-".concat(Date.now(),".png");x.a.saveAs(this.sprite.image,e)}catch(t){console.log(t),alert("Looks like your browser doesn't support this feature ðŸ˜¢")}},onFilesUploaded:function(e){this.fetchFiles(e)},onFilesDrop:function(e){this.fetchFiles(e)},fetchFiles:function(e){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function n(){var r,i,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=Array.from(e).map(function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=t.name,e.next=3,Q(t);case 3:return e.t1=e.sent,e.abrupt("return",{name:e.t0,buffer:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.next=3,Promise.all(i);case 3:a=n.sent,(r=t.files).push.apply(r,Object(y["a"])(a)),t.tryUpdate();case 6:case"end":return n.stop()}}),n)})))()},clickRemoveFile:function(e){this.files.splice(e,1),this.tryUpdate()},clearClick:function(){this.files=[],this.setDefaults()},filesAsBuffers:function(){return this.files.map((function(e){return e.buffer}))},applyDisplay:function(e){var t=e.options,n=t.grid,r=t.frame,i=t.pivot;this.grid.x=n.x,this.grid.y=n.y,this.sprite.size.x=n.x*r.width,this.sprite.size.y=n.y*r.height,this.pivot.x=i.x,this.pivot.y=i.y},createHorizontal:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new K(e.filesAsBuffers(),e.useNextPow2),t.next=3,n.createHorizontal(e.pivot);case 3:r=t.sent,e.sprite.image=r,e.applyDisplay(n),console.log("createHorizontal");case 7:case"end":return t.stop()}}),t)})))()},createVertical:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new K(e.filesAsBuffers(),e.useNextPow2),t.next=3,n.createVertical(e.pivot);case 3:r=t.sent,e.sprite.image=r,e.applyDisplay(n),console.log("createVertical");case 7:case"end":return t.stop()}}),t)})))()},createGrid:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new K(e.filesAsBuffers(),e.useNextPow2),t.next=3,n.createGrid(e.grid,e.pivot);case 3:r=t.sent,e.sprite.image=r,e.applyDisplay(n),console.log("createGrid");case 7:case"end":return t.stop()}}),t)})))()},onFileDragEnd:function(e,t){this.files=t,this.tryUpdate()},tryUpdate:function(){this.autoUpdate&&(this.files.length>0?this.createGrid():this.setDefaults())},setDefaults:function(){this.sprite.image="./images/placeholder.png",this.sprite.size={x:500,y:500},this.grid={x:2,y:2},this.pivot={x:.5,y:.5}}},watch:{useNextPow2:function(){this.tryUpdate()},"grid.x":function(){this.tryUpdate()},"grid.y":function(){this.tryUpdate()},"pivot.x":function(){this.tryUpdate()},"pivot.y":function(){this.tryUpdate()}},computed:{hasNoFiles:function(){return 0===this.files.length}}};n("7053");const Z=U()(W,[["render",g]]);var ee=Z;Object(r["createApp"])(ee).mount("#app")},7053:function(e,t,n){"use strict";n("a626")},a626:function(e,t,n){}});
//# sourceMappingURL=app.8032b8a4.js.map